/**
  ******************************************************************************
  * File Name          : main.c
  * Description        : Main program body
  ******************************************************************************
  ** This notice applies to any and all portions of this file
  * that are not between comment pairs USER CODE BEGIN and
  * USER CODE END. Other portions of this file, whether 
  * inserted by the user or by software development tools
  * are owned by their respective copyright owners.
  *
  * COPYRIGHT(c) 2017 STMicroelectronics
  *
  * Redistribution and use in source and binary forms, with or without modification,
  * are permitted provided that the following conditions are met:
  *   1. Redistributions of source code must retain the above copyright notice,
  *      this list of conditions and the following disclaimer.
  *   2. Redistributions in binary form must reproduce the above copyright notice,
  *      this list of conditions and the following disclaimer in the documentation
  *      and/or other materials provided with the distribution.
  *   3. Neither the name of STMicroelectronics nor the names of its contributors
  *      may be used to endorse or promote products derived from this software
  *      without specific prior written permission.
  *
  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
  ******************************************************************************
  */
/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include "stm32f4xx_hal.h"

/* USER CODE BEGIN Includes */
/* Motor driver. */
#include "../../../Dynamixel_AX-12A_Driver/src/Dynamixel_AX-12A.h"
#include "../../../Dynamixel_AX-12A_Driver/src/Dynamixel_AX-12A.c"
/* USER CODE END Includes */

/* Private variables ---------------------------------------------------------*/
TIM_HandleTypeDef htim10;

UART_HandleTypeDef huart2;

/* USER CODE BEGIN PV */
/* Private variables ---------------------------------------------------------*/
Dynamixel_HandleTypeDef Motor1;
Dynamixel_HandleTypeDef Motor2;
Dynamixel_HandleTypeDef Motor3;

const double HIP[] = {
		-1.005,-1.005,-0.99084,-0.97042,-0.94597,-0.91938,-0.89214,-0.86548,-0.84035,-0.81753,-0.79766,-0.78127,-0.76879,-0.76071,-0.75728,-0.75857,-0.7645,-0.77485,-0.78917,-0.80681,-0.82687,-0.84812,-0.86899,-0.88752,-0.90134,-0.90786,-0.90992,-0.91217,-0.91459,-0.9172,-0.92001,-0.92301,-0.92622,-0.92963,-0.93325,-0.93709,-0.94115,-0.94544,-0.94997,-0.95436,-0.95863,-0.96276,-0.96674,-0.97058,-0.97426,-0.97778,-0.98114,-0.98433,-0.98735,-0.99018,-0.99284,-0.99531,-0.9976,-0.99969,-1.0016,-1.0033,-1.0048,-1.0061,-1.0071,-1.008,-1.0086,-1.0091,-1.0093,-1.0093,-1.0096,-1.0103,-1.0113,-1.0126,-1.0142,-1.0162,-1.0185,-1.0211,-1.0241,-1.0275,-1.0312,-1.0353,-1.0398,-1.0446,-1.0499,-1.0555,-1.0615,-1.068,-1.0749,-1.0822,-1.09,-1.0982,-1.1069,-1.116,-1.1257,-1.135,-1.1441,-1.1529,-1.1614,-1.1695,-1.1773,-1.1847,-1.1918,-1.1985,-1.2049,-1.2108,-1.2164,-1.2145,-1.1998,-1.1751,-1.1429,-1.1054,-1.0641,-1.0205,-0.97582,-0.93118,-0.8877,-0.8465,-0.80873,-0.77547,-0.74854,-0.72859,-0.71599,-0.71076,-0.71255,-0.72065,-0.73394,-0.75089,-0.76951,-0.78733,-0.80148,-0.80895,-0.81228,-0.81595,-0.81998,-0.82439,-0.8292,-0.83443,-0.84011,-0.84625,-0.85288,-0.86003,-0.86771,-0.87595,-0.88479,-0.8935,-0.90206,-0.91044,-0.91861,-0.92655,-0.93423,-0.94163,-0.94874,-0.95552,-0.96197,-0.96806,-0.97379,-0.97913,-0.98407,-0.98861,-0.99272,-0.99641,-0.99965,-1.0025,-1.0048,-1.0067,-1.0081,-1.009,-1.0095,-1.0095,-1.0101,-1.0112,-1.0129,-1.0151,-1.0179,-1.0213,-1.0252,-1.0298,-1.035,-1.0408,-1.0472,-1.0543,-1.062,-1.0704,-1.0796,-1.0894,-1.1,-1.1113,-1.1235,-1.1364,-1.1502,-1.1648,-1.1803,-1.1967,-1.214,-1.2309,-1.2473,-1.2632,-1.2786,-1.2934,-1.3076,-1.3213,-1.3343,-1.3466,-1.3583,-1.3693,-1.3796,-1.3801,-1.3637,-1.3338,-1.2935,-1.2453,-1.1912,-1.1329,-1.0719,-1.0095,-0.94721,-0.88677,-0.82995,-0.77857,-0.73559,-0.70213,-0.67882,-0.66575,-0.66246,-0.66797,-0.68076,-0.69881,-0.71949,-0.73956,-0.75529,-0.76294,-0.76563,-0.76874,-0.77231,-0.77638,-0.78099,-0.78621,-0.79206,-0.79859,-0.80586,-0.81392,-0.82281,-0.83259,-0.8433,-0.85407,-0.86484,-0.87554,-0.88611,-0.8965,-0.90664,-0.9165,-0.92604,-0.9352,-0.94396,-0.95229,-0.96014,-0.96749,-0.97432,-0.9806,-0.98631,-0.99144,-0.99596,-0.99986,-1.0031,-1.0058,-1.0078,-1.0091,-1.0097,-1.0097,-1.0105,-1.0119,-1.0141,-1.017,-1.0206,-1.025,-1.0301,-1.0361,-1.0428,-1.0504,-1.0588,-1.068,-1.0782,-1.0892,-1.1012,-1.1142,-1.1282,-1.1432,-1.1593,-1.1765,-1.1948,-1.2144,-1.2351,-1.2571,-1.2804,-1.3032,-1.3254,-1.347,-1.3679,-1.3881,-1.4076,-1.4263,-1.4442,-1.4613,-1.4775,-1.4928,-1.5072,-1.5095,-1.4911,-1.4562,-1.4087,-1.3516,-1.2875,-1.218,-1.1448,-1.0694,-0.99351,-0.91916,-0.84866,-0.78444,-0.73037,-0.68797,-0.65807,-0.64078,-0.63551,-0.641,-0.6554,-0.67624,-0.70029,-0.72351,-0.74117,-0.74857,-0.74979,-0.75147,-0.75368,-0.75649,-0.75995,-0.76415,-0.76914,-0.775,-0.7818,-0.78961,-0.79849,-0.80851,-0.81976,-0.83129,-0.84301,-0.8548,-0.86658,-0.87826,-0.88976,-0.90102,-0.91197,-0.92255,-0.9327,-0.94238,-0.95155,-0.96015,-0.96817,-0.97555,-0.98228,-0.98832,-0.99366,-0.99827,-1.0021,-1.0053,-1.0076,-1.0092,-1.01,-1.01,-1.0108,-1.0124,-1.0149,-1.0181,-1.0223,-1.0273,-1.0331,-1.0399,-1.0475,-1.0561,-1.0657,-1.0763,-1.0879,-1.1005,-1.1143,-1.1291,-1.1452,-1.1624,-1.1809,-1.2007,-1.2218,-1.2443,-1.2683,-1.2938,-1.3208,-1.3472,-1.3731,-1.3982,-1.4226,-1.4463,-1.4692,-1.4912,-1.5123,-1.5326,-1.5519,-1.5702,-1.5874,-1.5909,-1.571,-1.5325,-1.4801,-1.4175,-1.3473,-1.2714,-1.1913,-1.1086,-1.0251,-0.94293,-0.86469,-0.79315,-0.73272,-0.68517,-0.65149,-0.63182,-0.62548,-0.63107,-0.64657,-0.66925,-0.69554,-0.72089,-0.73983,-0.74701,-0.74714,-0.74776,-0.74895,-0.7508,-0.75338,-0.75677,-0.76105,-0.76631,-0.77261,-0.78005,-0.78869,-0.79863,-0.80993,-0.82165,-0.83367,-0.84586,-0.85811,-0.87031,-0.88239,-0.89424,-0.9058,-0.91699,-0.92776,-0.93805,-0.9478,-0.95697,-0.96551,-0.97339,-0.98057,-0.98703,-0.99274,-0.99767,-1.0018,-1.0051,-1.0077,-1.0093,-1.0102,-1.0102,-1.011,-1.0127,-1.0153,-1.0187,-1.0229,-1.0281,-1.0342,-1.0412,-1.0491,-1.058,-1.0679,-1.0789,-1.0909,-1.104,-1.1183,-1.1337,-1.1503,-1.1682,-1.1874,-1.2079,-1.2299,-1.2532,-1.2781,-1.3046,-1.3326,-1.3601,-1.387,-1.4132,-1.4386,-1.4632,-1.4871,-1.5101,-1.5322,-1.5533,-1.5735,-1.5927,-1.6108,-1.6148,-1.5946,-1.5554,-1.5021,-1.4386,-1.3674,-1.2905,-1.2095,-1.1257,-1.0411,-0.95761,-0.87791,-0.80477,-0.7427,-0.69353,-0.65832,-0.63724,-0.62964,-0.63414,-0.64869,-0.67058,-0.69623,-0.7211,-0.7398,-0.74701,-0.74734,-0.74815,-0.74954,-0.75157,-0.75432,-0.75788,-0.76231,-0.7677,-0.77413,-0.78167,-0.79039,-0.80039,-0.81172,-0.82345,-0.83546,-0.84761,-0.85981,-0.87195,-0.88394,-0.89571,-0.90718,-0.91828,-0.92895,-0.93913,-0.94878,-0.95785,-0.9663,-0.97409,-0.98118,-0.98756,-0.9932,-0.99807,-1.0022,-1.0054,-1.0079,-1.0096,-1.0104,-1.0104,-1.0112,-1.0128,-1.0152,-1.0185,-1.0226,-1.0275,-1.0333,-1.0399,-1.0475,-1.056,-1.0654,-1.0758,-1.0872,-1.0996,-1.1132,-1.1278,-1.1435,-1.1604,-1.1785,-1.1979,-1.2186,-1.2406,-1.264,-1.2889,-1.3153,-1.3411,-1.3662,-1.3907,-1.4144,-1.4374,-1.4596,-1.481,-1.5015,-1.521,-1.5397,-1.5573,-1.5739,-1.5775,-1.5587,-1.5223,-1.4727,-1.4133,-1.3467,-1.2747,-1.1987,-1.1203,-1.041,-0.96291,-0.8882,-0.81942,-0.76067,-0.71364,-0.67935,-0.65803,-0.64915,-0.65151,-0.66324,-0.68186,-0.70414,-0.72609,-0.74307,-0.75052,-0.75218,-0.7543,-0.75694,-0.76015,-0.76401,-0.76857,-0.7739,-0.78006,-0.78711,-0.79512,-0.80415,-0.81427,-0.82553,-0.83702,-0.84863,-0.86027,-0.87186,-0.88331,-0.89456,-0.90554,-0.91619,-0.92647,-0.93631,-0.94568,-0.95453,-0.96283,-0.97055,-0.97765,-0.98411,-0.98991,-0.99503,-0.99945,-1.0031,-1.0061,-1.0084,-1.0099,-1.0106,-1.0106,-1.0113,-1.0127,-1.0148,-1.0176,-1.0212,-1.0254,-1.0305,-1.0362,-1.0427,-1.05,-1.0581,-1.0671,-1.0769,-1.0875,-1.099,-1.1115,-1.1249,-1.1393,-1.1546,-1.171,-1.1885,-1.2071,-1.2268,-1.2477,-1.2697,-1.2913,-1.3122,-1.3325,-1.3522,-1.3711,-1.3894,-1.4069,-1.4236,-1.4395,-1.4545,-1.4687,-1.4821,-1.4844,-1.4681,-1.437,-1.3945,-1.3436,-1.2863,-1.2245,-1.1594,-1.0924,-1.025,-0.95875,-0.89551,-0.8372,-0.78718,-0.74678,-0.71686,-0.69768,-0.68892,-0.68965,-0.69837,-0.71307,-0.73111,-0.7493,-0.76398,-0.7715,-0.77458,-0.77806,-0.78199,-0.7864,-0.79133,-0.79682,-0.80291,-0.80963,-0.81702,-0.82514,-0.83401,-0.84367,-0.85418,-0.86468,-0.8751,-0.8854,-0.89551,-0.90541,-0.91504,-0.92436,-0.93333,-0.94193,-0.95013,-0.95789,-0.96519,-0.97201,-0.97833,-0.98413,-0.98939,-0.9941,-0.99825,-1.0018,-1.0048,-1.0072,-1.009,-1.0102,-1.0108,-1.0108,-1.0114,-1.0124,-1.014,-1.0161,-1.0188,-1.022,-1.0257,-1.03,-1.0349,-1.0403,-1.0463,-1.0529,-1.0601,-1.0679,-1.0763,-1.0854,-1.0952,-1.1056,-1.1167,-1.1285,-1.141,-1.1543,-1.1683,-1.1832,-1.1988,-1.2139,-1.2286,-1.2428,-1.2565,-1.2696,-1.2822,-1.2943,-1.3057,-1.3166,-1.3268,-1.3364,-1.3454,-1.3459,-1.3321,-1.3071,-1.2736,-1.2338,-1.1895,-1.1422,-1.093,-1.043,-0.99337,-0.94521,-0.89976,-0.85828,-0.823,-0.79482,-0.77431,-0.76168,-0.75675,-0.75889,-0.76705,-0.77972,-0.79494,-0.81027,-0.82289,-0.82987,-0.83325,-0.83695,-0.84098,-0.84535,-0.85007,-0.85517,-0.86065,-0.86653,-0.87282,-0.87955,-0.88672,-0.89435,-0.90246,-0.9104,-0.91814,-0.92567,-0.93296,-0.94,-0.94677,-0.95326,-0.95946,-0.96535,-0.97091,-0.97615,-0.98105,-0.9856,-0.98979,-0.99362,-0.99708,-1.0002,-1.0029,-1.0052,-1.0072,-1.0087,-1.0099,-1.0107,-1.0111,-1.0111,-1.0113,-1.0119,-1.0128,-1.0139,-1.0154,-1.0171,-1.0191,-1.0214,-1.024,-1.0269,-1.03,-1.0335,-1.0373,-1.0413,-1.0457,-1.0504,-1.0554,-1.0607,-1.0663,-1.0722,-1.0785,-1.0851,-1.092,-1.0993,-1.1069,-1.1142,-1.1213,-1.1281,-1.1346,-1.1408,-1.1467,-1.1524,-1.1577,-1.1627,-1.1675,-1.1719,-1.176,-1.1741,-1.1623,-1.1431,-1.1189,-1.0913,-1.062,-1.0321,-1.0024,-0.97386,-0.94702,-0.92252,-0.90093,-0.88279,-0.86903,-0.85997,-0.85581,-0.85654,-0.86192,-0.87147,-0.8844,-0.89959,-0.91552,-0.93028,-0.9416,-0.94694,-0.94851,-0.9502,-0.95201,-0.95393,-0.95597,-0.95813,-0.9604,-0.96278,-0.96528,-0.9679,-0.97064,-0.97349,-0.97645,-0.97929,-0.98202,-0.98461,-0.98709,-0.98944,-0.99168,-0.99378,-0.99577,-0.99763,-0.99937,-1.001,-1.0025,-1.0039,-1.0051,-1.0062,-1.0073,-1.0082,-1.0089,-1.0096,-1.0102,-1.0106,-1.0109,-1.0112,-1.0113,-1.0113,-1.0113,-1.0112,-1.0112,-1.0111,-1.011,-1.0108,-1.0107,-1.0105,-1.0102,-1.01,-1.0097,-1.0094,-1.009,-1.0086,-1.0081,-1.0076,-1.0071,-1.0065,-1.0059,-1.0052,-1.0045,-1.0037,-1.0028,-1.002,-1.001,-1,-0.999,-0.99793,-0.99683,-0.99569,-0.99451,-0.99329,-0.99204,-0.99075,-0.98942,-0.98805,-0.98664
};

const double KNEE[] = {
		-1.181,-1.181,-1.2072,-1.2445,-1.288,-1.3341,-1.3796,-1.422,-1.4594,-1.4906,-1.5145,-1.5304,-1.5377,-1.5364,-1.5264,-1.508,-1.4817,-1.4483,-1.4088,-1.3646,-1.3175,-1.2702,-1.2256,-1.1878,-1.1615,-1.1521,-1.1529,-1.1538,-1.1548,-1.1557,-1.1567,-1.1577,-1.1588,-1.1598,-1.1609,-1.162,-1.163,-1.164,-1.165,-1.1659,-1.1667,-1.1674,-1.168,-1.1686,-1.169,-1.1694,-1.1697,-1.17,-1.1703,-1.1705,-1.1706,-1.1707,-1.1708,-1.1709,-1.171,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.1709,-1.1708,-1.1706,-1.1704,-1.1702,-1.1698,-1.1694,-1.1688,-1.1682,-1.1674,-1.1664,-1.1653,-1.1639,-1.1624,-1.1606,-1.1586,-1.1562,-1.1535,-1.1508,-1.1479,-1.145,-1.142,-1.1391,-1.1361,-1.1331,-1.1302,-1.1274,-1.1247,-1.122,-1.1195,-1.1286,-1.157,-1.1989,-1.2489,-1.3023,-1.3556,-1.4057,-1.4502,-1.4874,-1.5157,-1.5341,-1.5419,-1.5387,-1.5245,-1.5,-1.4658,-1.4232,-1.3736,-1.319,-1.2616,-1.2047,-1.152,-1.1083,-1.0795,-1.0716,-1.0763,-1.0812,-1.0863,-1.0916,-1.097,-1.1025,-1.1081,-1.1138,-1.1194,-1.125,-1.1305,-1.1358,-1.141,-1.1456,-1.1496,-1.1531,-1.1562,-1.1589,-1.1612,-1.1631,-1.1648,-1.1661,-1.1673,-1.1682,-1.169,-1.1695,-1.17,-1.1704,-1.1706,-1.1708,-1.1709,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.1709,-1.1708,-1.1705,-1.1702,-1.1697,-1.1691,-1.1683,-1.1673,-1.166,-1.1644,-1.1625,-1.1602,-1.1574,-1.1542,-1.1504,-1.1459,-1.1408,-1.1349,-1.1282,-1.1206,-1.1126,-1.1044,-1.0961,-1.0876,-1.079,-1.0705,-1.062,-1.0536,-1.0454,-1.0375,-1.0298,-1.0224,-1.0298,-1.0619,-1.1117,-1.1724,-1.2381,-1.3043,-1.3671,-1.4235,-1.4711,-1.5078,-1.532,-1.5427,-1.5391,-1.5214,-1.4904,-1.4472,-1.3935,-1.3314,-1.2632,-1.1921,-1.1219,-1.0576,-1.0052,-0.97224,-0.96625,-0.97634,-0.98686,-0.99776,-1.009,-1.0204,-1.032,-1.0437,-1.0554,-1.067,-1.0785,-1.0897,-1.1006,-1.1111,-1.1204,-1.1285,-1.1356,-1.1417,-1.147,-1.1516,-1.1555,-1.1587,-1.1614,-1.1637,-1.1655,-1.167,-1.1681,-1.169,-1.1697,-1.1702,-1.1705,-1.1708,-1.1709,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.1709,-1.1708,-1.1705,-1.1701,-1.1696,-1.1688,-1.1677,-1.1664,-1.1647,-1.1626,-1.1599,-1.1567,-1.1528,-1.1482,-1.1428,-1.1364,-1.129,-1.1204,-1.1106,-1.0993,-1.0865,-1.0732,-1.0594,-1.0452,-1.0308,-1.0162,-1.0016,-0.98709,-0.97268,-0.9585,-0.94464,-0.93121,-0.91827,-0.92372,-0.96025,-1.019,-1.0914,-1.1702,-1.2497,-1.3254,-1.3938,-1.452,-1.4974,-1.5281,-1.5425,-1.5398,-1.52,-1.4841,-1.4337,-1.3708,-1.2978,-1.2177,-1.1341,-1.0513,-0.9754,-0.91397,-0.87634,-0.87206,-0.88746,-0.90343,-0.91987,-0.93667,-0.95373,-0.97093,-0.98816,-1.0053,-1.0223,-1.039,-1.0552,-1.0709,-1.086,-1.0993,-1.1109,-1.121,-1.1297,-1.1372,-1.1437,-1.1492,-1.1538,-1.1576,-1.1607,-1.1633,-1.1654,-1.167,-1.1682,-1.1692,-1.1698,-1.1703,-1.1707,-1.1709,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.1709,-1.1707,-1.1703,-1.1698,-1.1691,-1.1681,-1.1668,-1.165,-1.1628,-1.1601,-1.1567,-1.1525,-1.1476,-1.1417,-1.1347,-1.1265,-1.117,-1.106,-1.0933,-1.0788,-1.0623,-1.045,-1.0271,-1.0087,-0.98996,-0.97094,-0.95178,-0.93261,-0.91354,-0.8947,-0.8762,-0.85817,-0.84073,-0.84463,-0.8848,-0.95072,-1.032,-1.1204,-1.2094,-1.2942,-1.371,-1.4366,-1.4884,-1.5241,-1.5419,-1.5407,-1.5206,-1.4828,-1.4289,-1.3612,-1.2824,-1.1956,-1.1047,-1.0145,-0.93137,-0.86404,-0.82321,-0.81983,-0.83847,-0.85771,-0.87743,-0.8975,-0.91779,-0.93817,-0.95853,-0.97873,-0.99865,-1.0182,-1.0371,-1.0555,-1.073,-1.0883,-1.1018,-1.1134,-1.1235,-1.1322,-1.1397,-1.146,-1.1512,-1.1556,-1.1593,-1.1622,-1.1646,-1.1664,-1.1678,-1.1689,-1.1697,-1.1702,-1.1706,-1.1708,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.1708,-1.1706,-1.1702,-1.1697,-1.1689,-1.1678,-1.1664,-1.1646,-1.1622,-1.1592,-1.1556,-1.1512,-1.1459,-1.1395,-1.1321,-1.1233,-1.1131,-1.1014,-1.0878,-1.0724,-1.0547,-1.0362,-1.0171,-0.99735,-0.97723,-0.95682,-0.93624,-0.91562,-0.89508,-0.87476,-0.85479,-0.83528,-0.81637,-0.81969,-0.86081,-0.92866,-1.0124,-1.1032,-1.1948,-1.2821,-1.3613,-1.4293,-1.4833,-1.5211,-1.541,-1.5417,-1.5232,-1.4867,-1.4339,-1.3671,-1.289,-1.2029,-1.1125,-1.0227,-0.94,-0.87296,-0.83219,-0.82853,-0.84668,-0.86543,-0.88466,-0.90423,-0.92402,-0.9439,-0.96377,-0.98348,-1.0029,-1.022,-1.0405,-1.0584,-1.0755,-1.0905,-1.1036,-1.115,-1.1248,-1.1333,-1.1405,-1.1467,-1.1518,-1.1561,-1.1596,-1.1625,-1.1648,-1.1666,-1.168,-1.169,-1.1697,-1.1703,-1.1706,-1.1709,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.1709,-1.1706,-1.1703,-1.1698,-1.1691,-1.1681,-1.1668,-1.1651,-1.163,-1.1603,-1.157,-1.1529,-1.1481,-1.1424,-1.1356,-1.1277,-1.1185,-1.1078,-1.0956,-1.0817,-1.0658,-1.0492,-1.032,-1.0143,-0.99636,-0.97816,-0.95986,-0.94158,-0.92343,-0.90551,-0.88796,-0.87088,-0.85438,-0.85832,-0.89694,-0.96026,-1.0385,-1.1237,-1.2098,-1.2921,-1.3671,-1.4317,-1.4833,-1.52,-1.54,-1.5424,-1.527,-1.4949,-1.4475,-1.3871,-1.3161,-1.2376,-1.1552,-1.0735,-0.99839,-0.93749,-0.89987,-0.89486,-0.90909,-0.92386,-0.93906,-0.95461,-0.9704,-0.98633,-1.0023,-1.0182,-1.0339,-1.0493,-1.0644,-1.079,-1.0929,-1.1051,-1.1159,-1.1252,-1.1332,-1.1402,-1.1461,-1.1511,-1.1554,-1.1589,-1.1617,-1.1641,-1.166,-1.1674,-1.1686,-1.1694,-1.17,-1.1704,-1.1707,-1.1709,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.1709,-1.1707,-1.1705,-1.1701,-1.1696,-1.1688,-1.1678,-1.1666,-1.1649,-1.1629,-1.1604,-1.1574,-1.1538,-1.1495,-1.1444,-1.1385,-1.1316,-1.1237,-1.1146,-1.1043,-1.0925,-1.0803,-1.0677,-1.0548,-1.0417,-1.0285,-1.0153,-1.0022,-0.98923,-0.97651,-0.96412,-0.95214,-0.94064,-0.94614,-0.98028,-1.035,-1.1024,-1.1759,-1.2504,-1.3218,-1.387,-1.4432,-1.4884,-1.5209,-1.5393,-1.5427,-1.5311,-1.5052,-1.4662,-1.4158,-1.3563,-1.29,-1.2204,-1.1513,-1.0876,-1.0356,-1.0023,-0.99541,-1.0042,-1.0133,-1.0227,-1.0324,-1.0423,-1.0524,-1.0625,-1.0725,-1.0826,-1.0924,-1.1021,-1.1115,-1.1205,-1.1284,-1.1353,-1.1413,-1.1466,-1.1511,-1.1549,-1.1582,-1.1609,-1.1632,-1.1651,-1.1666,-1.1678,-1.1687,-1.1695,-1.17,-1.1704,-1.1707,-1.1709,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.1709,-1.1707,-1.1705,-1.1702,-1.1698,-1.1692,-1.1685,-1.1676,-1.1664,-1.165,-1.1633,-1.1613,-1.1589,-1.156,-1.1527,-1.1489,-1.1445,-1.1395,-1.1338,-1.1273,-1.1206,-1.1137,-1.1067,-1.0997,-1.0926,-1.0855,-1.0785,-1.0717,-1.065,-1.0585,-1.0522,-1.0463,-1.0537,-1.0835,-1.1291,-1.1844,-1.2445,-1.3051,-1.363,-1.4157,-1.461,-1.4974,-1.5236,-1.5388,-1.5422,-1.5339,-1.5142,-1.484,-1.4445,-1.3972,-1.3442,-1.288,-1.2317,-1.1794,-1.1357,-1.1065,-1.0977,-1.1013,-1.1051,-1.109,-1.113,-1.1171,-1.1212,-1.1255,-1.1297,-1.1339,-1.138,-1.1421,-1.146,-1.1498,-1.1531,-1.1561,-1.1586,-1.1608,-1.1627,-1.1643,-1.1657,-1.1669,-1.1678,-1.1686,-1.1692,-1.1697,-1.1701,-1.1704,-1.1707,-1.1708,-1.1709,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.171,-1.1709,-1.1708,-1.1707,-1.1705,-1.1703,-1.17,-1.1697,-1.1693,-1.1688,-1.1682,-1.1675,-1.1667,-1.1657,-1.1646,-1.1634,-1.162,-1.1604,-1.1586,-1.1567,-1.1548,-1.1528,-1.1509,-1.149,-1.1471,-1.1452,-1.1433,-1.1415,-1.1398,-1.1382,-1.1366,-1.1457,-1.1726,-1.2115,-1.2577,-1.3071,-1.3562,-1.4026,-1.4443,-1.4798,-1.5078,-1.5276,-1.5386,-1.5406,-1.5333,-1.5172,-1.4926,-1.4604,-1.4217,-1.378,-1.3311,-1.2837,-1.239,-1.2009,-1.1742,-1.1644,-1.1647,-1.1651,-1.1655,-1.1658,-1.1662,-1.1666,-1.167,-1.1674,-1.1678,-1.1682,-1.1686,-1.1689,-1.1693,-1.1696,-1.1698,-1.1701,-1.1702,-1.1704,-1.1705,-1.1707,-1.1708,-1.1708,-1.1709,-1.171,-1.171,-1.171,-1.171,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.1711,-1.171,-1.171,-1.171,-1.171,-1.171,-1.171,-1.1709,-1.1709,-1.1708,-1.1708,-1.1708,-1.1707,-1.1706,-1.1706,-1.1705,-1.1704,-1.1703,-1.1702
};

const double ANKLE[] = {
		0.61518,0.61518,0.62726,0.64407,0.66322,0.68269,0.7009,0.71663,0.729,0.73738,0.74139,0.74083,0.73568,0.72627,0.71286,0.69578,0.67544,0.65235,0.62714,0.60058,0.57362,0.5475,0.52381,0.50454,0.49208,0.48917,0.49207,0.4952,0.49855,0.50213,0.50593,0.50996,0.5142,0.51867,0.52335,0.52825,0.53336,0.53868,0.5442,0.54949,0.55455,0.55937,0.56397,0.56834,0.57248,0.57639,0.58009,0.58356,0.58681,0.58984,0.59266,0.59526,0.59764,0.5998,0.60175,0.60349,0.60501,0.60631,0.6074,0.60827,0.60893,0.60937,0.60959,0.60959,0.60992,0.61057,0.61154,0.61284,0.61446,0.6164,0.61866,0.62125,0.62414,0.62735,0.63087,0.63468,0.6388,0.64321,0.6479,0.65287,0.65811,0.66361,0.66936,0.67535,0.68156,0.68799,0.69462,0.70144,0.70842,0.71502,0.72124,0.72709,0.73259,0.73774,0.74256,0.74706,0.75125,0.75514,0.75874,0.76205,0.76509,0.77227,0.786,0.80321,0.82101,0.83691,0.84889,0.85538,0.85525,0.84778,0.83262,0.80984,0.77985,0.74334,0.70227,0.65778,0.61104,0.56319,0.5154,0.46883,0.42478,0.38477,0.35069,0.32488,0.31018,0.30973,0.31774,0.32632,0.33547,0.34517,0.35541,0.36618,0.37746,0.38923,0.40149,0.41422,0.42739,0.44099,0.45499,0.46828,0.48088,0.49279,0.50404,0.51464,0.52461,0.53396,0.54271,0.55087,0.55846,0.56548,0.57195,0.57788,0.58328,0.58816,0.59253,0.5964,0.59977,0.60265,0.60504,0.60695,0.60838,0.60933,0.60981,0.60981,0.61037,0.61148,0.61314,0.61534,0.6181,0.62138,0.6252,0.62953,0.63437,0.63971,0.64552,0.6518,0.65852,0.66567,0.67321,0.68113,0.68939,0.69798,0.70685,0.71596,0.72529,0.73478,0.7444,0.75409,0.7638,0.77274,0.78096,0.78849,0.79537,0.80164,0.80732,0.81247,0.81711,0.82127,0.825,0.82831,0.83125,0.83909,0.85483,0.87472,0.89506,0.91261,0.92471,0.92922,0.92458,0.90973,0.88417,0.84798,0.80182,0.74686,0.68619,0.62169,0.55523,0.48849,0.42306,0.36041,0.3021,0.24995,0.20627,0.17399,0.15673,0.15839,0.17117,0.1848,0.19927,0.21455,0.23061,0.24742,0.26496,0.28319,0.30209,0.32162,0.34174,0.36242,0.38363,0.40365,0.42254,0.44033,0.45705,0.47275,0.48744,0.50117,0.51397,0.52585,0.53685,0.547,0.55632,0.56482,0.57254,0.5795,0.5857,0.59117,0.59593,0.59998,0.60335,0.60602,0.60803,0.60936,0.61003,0.61003,0.61075,0.61218,0.61433,0.61718,0.62072,0.62495,0.62984,0.63539,0.64156,0.64835,0.65571,0.66363,0.67207,0.68099,0.69035,0.70011,0.71023,0.72063,0.73128,0.7421,0.75303,0.76398,0.77489,0.78565,0.79618,0.8056,0.81398,0.82139,0.82789,0.83355,0.83842,0.84257,0.84606,0.84895,0.85131,0.85318,0.85464,0.8624,0.88055,0.90442,0.92928,0.95104,0.96636,0.97263,0.96783,0.95057,0.92011,0.87647,0.82041,0.75345,0.67957,0.60127,0.52096,0.44077,0.36254,0.28794,0.21867,0.15677,0.10489,0.066685,0.04671,0.049832,0.066455,0.084112,0.10276,0.12237,0.14289,0.16428,0.1865,0.20952,0.23329,0.25777,0.28291,0.30866,0.33498,0.35976,0.38306,0.40495,0.42548,0.4447,0.46265,0.47938,0.49493,0.50934,0.52265,0.53489,0.54611,0.55634,0.5656,0.57392,0.58133,0.58786,0.59352,0.59834,0.60233,0.60551,0.60788,0.60946,0.61025,0.61025,0.61106,0.61269,0.61512,0.61834,0.62235,0.62712,0.63264,0.63888,0.64583,0.65344,0.66168,0.67052,0.67991,0.6898,0.70014,0.71088,0.72195,0.73327,0.74478,0.75638,0.76799,0.7795,0.79081,0.80179,0.8123,0.82148,0.8294,0.83614,0.8418,0.84644,0.85015,0.85301,0.85509,0.85649,0.85727,0.85753,0.85733,0.86478,0.88498,0.91238,0.94134,0.9671,0.98588,0.99476,0.99149,0.97444,0.94271,0.89622,0.83578,0.76308,0.68255,0.59713,0.50955,0.42219,0.33705,0.25589,0.18047,0.11291,0.056112,0.01413,-0.0077579,-0.0039631,0.014805,0.034671,0.055586,0.077501,0.10037,0.12414,0.14878,0.17424,0.20046,0.22741,0.25504,0.28329,0.3121,0.33919,0.36464,0.3885,0.41085,0.43175,0.45124,0.46939,0.48624,0.50184,0.51623,0.52946,0.54156,0.55258,0.56255,0.5715,0.57947,0.58648,0.59255,0.59772,0.60199,0.60539,0.60793,0.60962,0.61047,0.61047,0.61131,0.61299,0.61551,0.61884,0.62298,0.62792,0.63362,0.64007,0.64723,0.65507,0.66356,0.67266,0.68231,0.69247,0.70308,0.71408,0.72539,0.73695,0.74866,0.76045,0.7722,0.78381,0.79516,0.80612,0.81654,0.82556,0.83325,0.83971,0.84502,0.84926,0.85253,0.8549,0.85647,0.85731,0.85752,0.85719,0.85639,0.86369,0.88459,0.91322,0.94368,0.97102,0.99138,1.0018,0.99994,0.98419,0.95357,0.90794,0.84809,0.77564,0.69509,0.6094,0.52139,0.43352,0.34786,0.26621,0.19037,0.12248,0.065435,0.023266,0.0011926,0.0047433,0.023224,0.042793,0.0634,0.084999,0.10754,0.13099,0.15528,0.18039,0.20626,0.23285,0.26011,0.28798,0.31641,0.34314,0.36824,0.39179,0.41384,0.43445,0.45368,0.47159,0.48821,0.50359,0.51778,0.53083,0.54276,0.55363,0.56346,0.57228,0.58014,0.58704,0.59303,0.59812,0.60234,0.60569,0.60819,0.60985,0.61068,0.61069,0.61149,0.6131,0.6155,0.61868,0.62263,0.62734,0.63279,0.63895,0.64579,0.65329,0.66142,0.67013,0.67938,0.68913,0.69932,0.7099,0.72081,0.73198,0.74333,0.75479,0.76626,0.77765,0.78886,0.79977,0.81024,0.81943,0.82739,0.83423,0.84,0.8448,0.84869,0.85177,0.8541,0.85576,0.85684,0.8574,0.85752,0.86503,0.88488,0.91178,0.94041,0.96625,0.98571,0.996,0.99499,0.98113,0.95355,0.9121,0.85745,0.79104,0.7169,0.63771,0.55607,0.47431,0.39444,0.31827,0.24761,0.18454,0.13174,0.092781,0.072142,0.074577,0.09047,0.10736,0.1252,0.14397,0.16361,0.1841,0.20539,0.22744,0.25021,0.27366,0.29775,0.32242,0.34763,0.37137,0.39369,0.41465,0.43431,0.4527,0.46987,0.48588,0.50075,0.51453,0.52726,0.53897,0.54969,0.55946,0.5683,0.57625,0.58332,0.58955,0.59496,0.59955,0.60336,0.60639,0.60865,0.61015,0.6109,0.6109,0.6116,0.613,0.61509,0.61785,0.62129,0.6254,0.63014,0.63551,0.64149,0.64806,0.65518,0.66284,0.67099,0.67961,0.68866,0.69809,0.70787,0.71793,0.72824,0.73872,0.74932,0.75997,0.7706,0.78112,0.79145,0.80075,0.80908,0.8165,0.82306,0.82884,0.83388,0.83825,0.842,0.84518,0.84786,0.85009,0.85191,0.85977,0.87762,0.90115,0.92607,0.94866,0.96593,0.9755,0.97556,0.96485,0.94265,0.90885,0.86397,0.80912,0.74749,0.68117,0.61226,0.54273,0.47438,0.4089,0.34798,0.29354,0.24792,0.21405,0.1955,0.19612,0.20794,0.22055,0.23392,0.24804,0.26287,0.27839,0.29457,0.31138,0.3288,0.34679,0.36531,0.38435,0.40385,0.42225,0.43961,0.45594,0.47129,0.48569,0.49916,0.51174,0.52346,0.53433,0.5444,0.55368,0.56219,0.56996,0.577,0.58334,0.589,0.59399,0.59832,0.602,0.60506,0.60749,0.60931,0.61052,0.61112,0.61112,0.61165,0.6127,0.61428,0.61636,0.61896,0.62206,0.62565,0.62972,0.63427,0.63927,0.64471,0.65058,0.65686,0.66353,0.67057,0.67795,0.68566,0.69366,0.70193,0.71043,0.71914,0.72802,0.73703,0.74613,0.75528,0.76375,0.77156,0.77875,0.78536,0.79141,0.79695,0.80199,0.80658,0.81073,0.81448,0.81785,0.82086,0.82882,0.84482,0.8654,0.88726,0.90752,0.92387,0.93445,0.9379,0.93326,0.92001,0.89806,0.86772,0.82969,0.78608,0.73821,0.68749,0.63534,0.58315,0.5323,0.48426,0.44067,0.40352,0.3752,0.35858,0.35681,0.36377,0.37122,0.37914,0.38753,0.39636,0.40562,0.41531,0.4254,0.43589,0.44676,0.45799,0.46956,0.48146,0.49274,0.5034,0.51348,0.52298,0.53192,0.54031,0.54818,0.55552,0.56236,0.56872,0.57459,0.57999,0.58493,0.58942,0.59348,0.5971,0.6003,0.60309,0.60546,0.60743,0.609,0.61017,0.61095,0.61134,0.61134,0.61163,0.6122,0.61306,0.6142,0.61562,0.61731,0.61927,0.6215,0.624,0.62675,0.62975,0.63301,0.6365,0.64023,0.64419,0.64837,0.65277,0.65737,0.66217,0.66716,0.67234,0.67768,0.68319,0.68884,0.69464,0.70012,0.70528,0.71014,0.71471,0.71899,0.723,0.72675,0.73024,0.73348,0.73647,0.73924,0.74178,0.74905,0.76406,0.78386,0.80579,0.82759,0.84744,0.86392,0.87597,0.88282,0.88401,0.87932,0.86875,0.85255,0.83156,0.80636,0.77763,0.74617,0.71283,0.67863,0.64473,0.61251,0.5837,0.56038,0.54504,0.54052,0.54244,0.54449,0.54667,0.54898,0.5514,0.55395,0.55662,0.5594,0.56229,0.56529,0.5684,0.57161,0.57492,0.57806,0.58104,0.58387,0.58654,0.58906,0.59143,0.59365,0.59573,0.59767,0.59947,0.60114,0.60268,0.60408,0.60536,0.60651,0.60754,0.60845,0.60923,0.6099,0.61046,0.6109,0.61123,0.61145,0.61156,0.61156,0.61154,0.6115,0.61144,0.61136,0.61125,0.61112,0.61095,0.61076,0.61053,0.61027,0.60997,0.60964,0.60927,0.60886,0.60841,0.60791,0.60737,0.60678,0.60614,0.60545,0.6047,0.60391,0.60305,0.60214,0.60117,0.60015,0.59909,0.59799,0.59684,0.59565,0.59442,0.59314,0.59181,0.59044,0.58903,0.58756,0.58605
};

const double PI = 3.141592654;
/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_USART2_UART_Init(void);
static void MX_TIM10_Init(void);

/* USER CODE BEGIN PFP */
/* Private function prototypes -----------------------------------------------*/

/* USER CODE END PFP */

/* USER CODE BEGIN 0 */

/* USER CODE END 0 */

int main(void)
{

  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration----------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_USART2_UART_Init();
  MX_TIM10_Init();

  /* USER CODE BEGIN 2 */
  Dynamixel_Init(&Motor1, 3, &huart2, GPIOD, GPIO_PIN_7);
  Dynamixel_Init(&Motor2, 7, &huart2, GPIOD, GPIO_PIN_7);
  Dynamixel_Init(&Motor3, 1, &huart2, GPIOD, GPIO_PIN_7);

  Dynamixel_HandleTypeDef* arrDynamixel[3];
  arrDynamixel[0] = &Motor1; // Top
  arrDynamixel[1] = &Motor2; // Middle
  arrDynamixel[2] = &Motor3; // Bottom

  Dynamixel_SetCWComplianceSlope(&Motor1, 6);
  Dynamixel_SetCWComplianceSlope(&Motor2, 6);
  Dynamixel_SetCWComplianceSlope(&Motor3, 6);
  Dynamixel_SetCCWComplianceSlope(&Motor1, 6);
  Dynamixel_SetCCWComplianceSlope(&Motor2, 6);
  Dynamixel_SetCCWComplianceSlope(&Motor3, 6);

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {
  /* USER CODE END WHILE */

  /* USER CODE BEGIN 3 */
	  int size = 1000;
	  for(int i = 0; i < size; i++){
		  Dynamixel_SetGoalPosition(&Motor1, (HIP[i] * 180 / PI) + 240);
		  Dynamixel_SetGoalPosition(&Motor2, (-1*KNEE[i] * 180 / PI) + 150);
		  Dynamixel_SetGoalPosition(&Motor3, (-1*ANKLE[i] * 180 / PI) + 150);
		  HAL_Delay(20);
	  }
  }
  /* USER CODE END 3 */

}

/** System Clock Configuration
*/
void SystemClock_Config(void)
{

  RCC_OscInitTypeDef RCC_OscInitStruct;
  RCC_ClkInitTypeDef RCC_ClkInitStruct;

    /**Configure the main internal regulator output voltage 
    */
  __HAL_RCC_PWR_CLK_ENABLE();

  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

    /**Initializes the CPU, AHB and APB busses clocks 
    */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;
  RCC_OscInitStruct.HSIState = RCC_HSI_ON;
  RCC_OscInitStruct.HSICalibrationValue = 16;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 180;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 2;
  RCC_OscInitStruct.PLL.PLLR = 2;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Activate the Over-Drive mode 
    */
  if (HAL_PWREx_EnableOverDrive() != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Initializes the CPU, AHB and APB busses clocks 
    */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV4;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Configure the Systick interrupt time 
    */
  HAL_SYSTICK_Config(HAL_RCC_GetHCLKFreq()/1000);

    /**Configure the Systick 
    */
  HAL_SYSTICK_CLKSourceConfig(SYSTICK_CLKSOURCE_HCLK);

  /* SysTick_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(SysTick_IRQn, 0, 0);
}

/* TIM10 init function */
static void MX_TIM10_Init(void)
{

  htim10.Instance = TIM10;
  htim10.Init.Prescaler = 90;
  htim10.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim10.Init.Period = 9999;
  htim10.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  if (HAL_TIM_Base_Init(&htim10) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/* USART2 init function */
static void MX_USART2_UART_Init(void)
{

  huart2.Instance = USART2;
  huart2.Init.BaudRate = 1000000;
  huart2.Init.WordLength = UART_WORDLENGTH_8B;
  huart2.Init.StopBits = UART_STOPBITS_1;
  huart2.Init.Parity = UART_PARITY_NONE;
  huart2.Init.Mode = UART_MODE_TX_RX;
  huart2.Init.HwFlowCtl = UART_HWCONTROL_NONE;
  huart2.Init.OverSampling = UART_OVERSAMPLING_16;
  if (HAL_UART_Init(&huart2) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/** Configure pins as 
        * Analog 
        * Input 
        * Output
        * EVENT_OUT
        * EXTI
     PD8   ------> USART3_TX
     PD9   ------> USART3_RX
     PA8   ------> USB_OTG_FS_SOF
     PA9   ------> USB_OTG_FS_VBUS
     PA10   ------> USB_OTG_FS_ID
     PA11   ------> USB_OTG_FS_DM
     PA12   ------> USB_OTG_FS_DP
*/
static void MX_GPIO_Init(void)
{

  GPIO_InitTypeDef GPIO_InitStruct;

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOH_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();
  __HAL_RCC_GPIOG_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOB, LD3_Pin|LD2_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(USB_PowerSwitchOn_GPIO_Port, USB_PowerSwitchOn_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOD, GPIO_PIN_7, GPIO_PIN_RESET);

  /*Configure GPIO pin : USER_Btn_Pin */
  GPIO_InitStruct.Pin = USER_Btn_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(USER_Btn_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : LD3_Pin LD2_Pin */
  GPIO_InitStruct.Pin = LD3_Pin|LD2_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pins : STLK_RX_Pin STLK_TX_Pin */
  GPIO_InitStruct.Pin = STLK_RX_Pin|STLK_TX_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF7_USART3;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pin : USB_PowerSwitchOn_Pin */
  GPIO_InitStruct.Pin = USB_PowerSwitchOn_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(USB_PowerSwitchOn_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : USB_OverCurrent_Pin */
  GPIO_InitStruct.Pin = USB_OverCurrent_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(USB_OverCurrent_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : USB_SOF_Pin USB_ID_Pin USB_DM_Pin USB_DP_Pin */
  GPIO_InitStruct.Pin = USB_SOF_Pin|USB_ID_Pin|USB_DM_Pin|USB_DP_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_FS;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pin : USB_VBUS_Pin */
  GPIO_InitStruct.Pin = USB_VBUS_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(USB_VBUS_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : PD7 */
  GPIO_InitStruct.Pin = GPIO_PIN_7;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

}

/* USER CODE BEGIN 4 */
void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef * htim){
	if(htim->Instance == TIM10){
	}
}
/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @param  None
  * @retval None
  */
void _Error_Handler(char * file, int line)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  while(1) 
  {
  }
  /* USER CODE END Error_Handler_Debug */ 
}

#ifdef USE_FULL_ASSERT

/**
   * @brief Reports the name of the source file and the source line number
   * where the assert_param error has occurred.
   * @param file: pointer to the source file name
   * @param line: assert_param error line source number
   * @retval None
   */
void assert_failed(uint8_t* file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
    ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */

}

#endif

/**
  * @}
  */ 

/**
  * @}
*/ 

/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/
